<br><div id="particles-js-background" class="container" ng-controller="mainController"> </div><div id="overlay" class="container" ng-controller="mainController"><br><br>
<h1> Kioptrix: Level 1.2 (3)</h1><br>
Vulnhub page: <a href="https://www.vulnhub.com/entry/kioptrix-level-12-3,24/">https://www.vulnhub.com/entry/kioptrix-level-12-3,24/</a><br>
<br>
<h3> Information gathering</h3>
<br>
Nmap scan:<br>
<br>
<img src="visual/images/writeups/kio3/1.png"><br>
<br>
Nikto scan:<br>
<br>
<img src="visual/images/writeups/kio3/2.png"><br>
<br>
Directory scan (through dirsearch):<br>
<br>
<img src="visual/images/writeups/kio3/3.png"><br>
<br>
<h3> Information gathering in the Website</h3>
<br>
List directories in /modules:<br>
<br>
<img src="visual/images/writeups/kio3/4.png"><br>
<br>
Check PHPAdmin page:<br>
<br>
<img src="visual/images/writeups/kio3/5.png"><br>
<br>
<h3> Lotus exploit</h3>
<br>
Locate it:<br>
<br>
<img src="visual/images/writeups/kio3/6.png"><br>
<br>
Run it:<br>
<br>
<img src="visual/images/writeups/kio3/7.png"><br>
<br>
The reverse shell is correctly created:<br>
<br>
<img src="visual/images/writeups/kio3/8.png"><br>
<br>
<h3> Recon phase</h3>
<br>
Find Kernel version:<br>
<br>
<img src="visual/images/writeups/kio3/9.png"><br>
<br>
Locate and read interesting files as admin.dat or salt.dat:<br>
<br>
<img src="visual/images/writeups/kio3/10.png"><br>
<br>
<br>
<img src="visual/images/writeups/kio3/12.png"><br>
<br>
I tried a lot of stuff in here, trying to deofuscate code and such, but no results. As always, it was far easier xDD<br>
<br>
<h3> Locate credentials </h3>
<br>
PHPadmin credentials are stored in clear text! In general if there is a database and you have low-privileged access, look for them! Usually they are stored in files with "config" in them. In this case:<br>
<br>
<img src="visual/images/writeups/kio3/18.png"><br>
<br>
<h3> PHPAdmin recon</h3>
<br>
Access using the website<br>
<br>
<img src="visual/images/writeups/kio3/19.png"><br>
<br>
Find the developers accounts table:<br>
<br>
<img src="visual/images/writeups/kio3/20.png"><br>
<br>
Read the values:<br>
<br>
<img src="visual/images/writeups/kio3/21.png"><br>
<br>
Crack them:<br>
<br>
<img src="visual/images/writeups/kio3/22.png"><br>
<br>
<h3> SSH access</h3>
<br>
<img src="visual/images/writeups/kio3/23.png"><br>
<br>
<h3> Get root!</h3>
<br>
Check what can each user do with "sudo -l". Loneferret can do anything! Maybe "sudo su" would be a faster way, but let us try to do it with... awk, for example xD:<br>
<br>
<img src="visual/images/writeups/kio3/24.png"><br>
<br>
<br>
<img src="visual/images/writeups/kio3/25.png"><br>
<br>
<br><br><br><br><script src="visual/particles/particles.js"></script><script src="visual/particles/particles_style_2.js"></script>